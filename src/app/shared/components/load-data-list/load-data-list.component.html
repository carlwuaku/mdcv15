<div class="flex-col gap4">

  <app-pagination [current_page]="currentPage" [total]="totalRows" [limit]="limit" (pageChanged)="setPage($event)"
    (limitChanged)="setLimit($event)"></app-pagination>


  <div class="mini-card">
    <em>{{selectedItems.length}} Selected:</em>
    <!-- <app-export-table [objects]="objects"></app-export-table> -->
    <button (click)="getData()" mat-stroked-button color="primary"><mat-icon>refresh</mat-icon> Reload </button>

  </div>
  <app-loading *ngIf="loading"></app-loading>
  <input matInput (keyup)="applyFilter($event)" placeholder="Filter">

  <div class="table-responsive">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" *ngIf="showTable" matSort>
      <ng-container *ngFor="let column of displayedColumns" matColumnDef="{{column}}">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> {{getColumnLabel(column)}} </th>
        <td mat-cell *matCellDef="let element; let i = index;">
          <span [ngSwitch]="column">
            <span *ngSwitchCase="'#'">{{i + 1}}</span>

            <span *ngSwitchCase="'actions'">
              <button mat-raised-button color="primary" [matMenuTriggerFor]="menu"
                aria-label="Example icon-button with a menu">
                <mat-icon>expand_more</mat-icon> Menu
              </button>
              <mat-menu #menu="matMenu">
                <ng-container *ngFor="let action of element.actions">
                  <ng-container [ngTemplateOutlet]="action.type === 'button' ? buttonTemplate : linkTemplate"
                    [ngTemplateOutletContext]="{ action: action }">
                  </ng-container>
                </ng-container>
              </mat-menu>

              <ng-template #buttonTemplate let-action="action">
                <button (click)="action.onClick(element)" mat-menu-item>
                  <mat-icon *ngIf="action.icon">{{ action.icon }}</mat-icon>
                  <span>{{ action.label }}</span>
                </button>
              </ng-template>

              <ng-template #linkTemplate let-action="action">
                <a routerLink="/{{action.link}}/{{element[action.linkProp]}}" mat-menu-item>
                  <mat-icon *ngIf="action.icon">{{ action.icon }}</mat-icon>
                  <span>{{ action.label }}</span>
                </a>
              </ng-template>
            </span>

            <span *ngSwitchDefault>
              {{element[column]}}
            </span>
          </span>

        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

    </table>
  </div>
</div>
